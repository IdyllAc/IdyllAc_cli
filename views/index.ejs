<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
</head>
<body>
  <h1>Welcome to Your Dashboard</h1>
  <div id="profile-container">
    <p>Loading profile...</p>
  </div>

  <script>
    // Fetch the accessToken from localStorage or a cookie
    const accessToken = localStorage.getItem('accessToken');
    console.log('Using token from localStorage:', token);


      fetch('https://anypay.cards/auth/dashboard', {
        method: 'GET',
        headers: {
          'Authorization': 'Bearer ' + accessToken
        }
      })
      
      .then(res => {
        if (!res.ok) throw new Error('Unauthorized or token expired');
        return res.json();
      })

      .then(data => {
        document.getElementById('profile-container').innerHTML = `
          <h2>Hello, ${data.user.name}</h2>
          <p>Email: ${data.user.email}</p>
          <p>User ID: ${data.user.id}</p>`;
      })


      if (!accessToken) {
        window.location.href = '/login'; // force re-login
      };
  </script>
</body>
</html>
